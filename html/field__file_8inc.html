<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>sites/all/modules/contrib/filefield/field_file.inc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>sites/all/modules/contrib/filefield/field_file.inc File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#a56eff88e875747bcaacd268163badd9">field_file_load</a> ($fid, $reset=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#3bd2944da87148acc1c84eecdb22df66">field_file_save_upload</a> ($source, $validators=array(), $dest=FALSE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#4fd6ba5c832548c4c456e736f6fc25e1">field_file_save_file</a> ($filepath, $validators=array(), $dest=FALSE, $account=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#10fec707b6053febac35f742ea14a638">field_file_save</a> ($node, &amp;$file)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#74e2e4f228eddabf95dc2c8e1b0ebfb4">field_file_delete</a> ($file, $force=FALSE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#e131f72d83f71a14c4b4311e654d77f5">_field_file_cache</a> ($file=NULL, $reset=FALSE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#1580d32589418f72cd928b93db4c571c">field_file_check_directory</a> (&amp;$directory, $mode=0, $form_item=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#1131c2060eba36813763eb04dd6d4843">field_file_strip_path</a> ($path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#f4979515f095d3531c51f752100da7b1">field_file_urlencode_path</a> ($path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="field__file_8inc.html#2750f1d216388271938e7c9b545d2695">field_file_references</a> ($file)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Common functionality for file handling CCK field modules. <hr><h2>Function Documentation</h2>
<a class="anchor" name="e131f72d83f71a14c4b4311e654d77f5"></a><!-- doxytag: member="field_file.inc::_field_file_cache" ref="e131f72d83f71a14c4b4311e654d77f5" args="($file=NULL, $reset=FALSE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_field_file_cache           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>reset</em> = <code>FALSE</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal cache, in order to minimize database queries for loading files. 
</div>
</div><p>
<a class="anchor" name="1580d32589418f72cd928b93db4c571c"></a><!-- doxytag: member="field_file.inc::field_file_check_directory" ref="1580d32589418f72cd928b93db4c571c" args="(&amp;$directory, $mode=0, $form_item=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_check_directory           </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>directory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>mode</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>form_item</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A silent version of <a class="el" href="file_8inc.html">file.inc</a>'s <a class="el" href="group__file.html#g1cae9f6fea37182a71710f0209d586dd">file_check_directory()</a>.<p>
This function differs from file_check_directory in that it checks for files when doing the directory check and it does not use <a class="el" href="bootstrap_8inc.html#d9223d86c7b08b1288274ce211d9bfa6">drupal_set_message()</a> when creating directories. This function may be removed in Drupal 7.<p>
Check that the directory exists and is writable. Directories need to have execute permissions to be considered a directory by FTP servers, etc.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$directory</em>&nbsp;</td><td>A string containing the name of a directory path. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$mode</em>&nbsp;</td><td>A Boolean value to indicate if the directory should be created if it does not exist or made writable if it is read-only. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$form_item</em>&nbsp;</td><td>An optional string containing the name of a form item that any errors will be attached to. This is useful for settings forms that require the user to specify a writable directory. If it can't be made to work, a form error will be set preventing them from saving the settings. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>FALSE when directory not found, or TRUE when directory exists. </dd></dl>

</div>
</div><p>
<a class="anchor" name="74e2e4f228eddabf95dc2c8e1b0ebfb4"></a><!-- doxytag: member="field_file.inc::field_file_delete" ref="74e2e4f228eddabf95dc2c8e1b0ebfb4" args="($file, $force=FALSE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_delete           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>force</em> = <code>FALSE</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete a field file and its database record.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$path</em>&nbsp;</td><td>A file object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$force</em>&nbsp;</td><td>Force File Deletion ignoring reference counting. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>mixed TRUE for success, Array for reference count block, or FALSE in the event of an error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a56eff88e875747bcaacd268163badd9"></a><!-- doxytag: member="field_file.inc::field_file_load" ref="a56eff88e875747bcaacd268163badd9" args="($fid, $reset=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_load           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>reset</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load a file from the database.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$fid</em>&nbsp;</td><td>A numeric file id or string containing the file path. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$reset</em>&nbsp;</td><td>Whether to reset the internal file_load cache. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A file array. </dd></dl>

</div>
</div><p>
<a class="anchor" name="2750f1d216388271938e7c9b545d2695"></a><!-- doxytag: member="field_file.inc::field_file_references" ref="2750f1d216388271938e7c9b545d2695" args="($file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_references           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a count of the references to a file by all modules. 
</div>
</div><p>
<a class="anchor" name="10fec707b6053febac35f742ea14a638"></a><!-- doxytag: member="field_file.inc::field_file_save" ref="10fec707b6053febac35f742ea14a638" args="($node, &amp;$file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_save           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>file</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Save a node file. Delete items if necessary and set new items as permanent.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$node</em>&nbsp;</td><td>Node object this file is be associated with. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$file</em>&nbsp;</td><td>File to be inserted, passed by reference since fid should be attached. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>array </dd></dl>

</div>
</div><p>
<a class="anchor" name="4fd6ba5c832548c4c456e736f6fc25e1"></a><!-- doxytag: member="field_file.inc::field_file_save_file" ref="4fd6ba5c832548c4c456e736f6fc25e1" args="($filepath, $validators=array(), $dest=FALSE, $account=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_save_file           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>filepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>validators</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>dest</em> = <code>FALSE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>account</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Save a file into a file node after running all the associated validators.<p>
This function is usually used to move a file from the temporary file directory to a permanent location. It may be used by import scripts or other modules that want to save an existing file into the database.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$filepath</em>&nbsp;</td><td>The local file path of the file to be saved. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$validators</em>&nbsp;</td><td>An optional, associative array of callback functions used to validate the file. The keys are function names and the values arrays of callback parameters which will be passed in after the user and file objects. The functions should return an array of error messages, an empty array indicates that the file passed validation. The functions will be called in the order specified. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$dest</em>&nbsp;</td><td>A string containing the directory $source should be copied to. If this is not provided or is not writable, the temporary directory will be used. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$account</em>&nbsp;</td><td>The user account object that should associated with the uploaded file. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An array containing the file information, or 0 in the event of an error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3bd2944da87148acc1c84eecdb22df66"></a><!-- doxytag: member="field_file.inc::field_file_save_upload" ref="3bd2944da87148acc1c84eecdb22df66" args="($source, $validators=array(), $dest=FALSE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_save_upload           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>validators</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>dest</em> = <code>FALSE</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Save a file upload to a new location. The source file is validated as a proper upload and handled as such. By implementing hook_file($op = 'insert'), modules are able to act on the file upload and to add their own properties to the file.<p>
The file will be added to the files table as a temporary file. Temporary files are periodically cleaned. To make the file permanent file call <a class="el" href="group__file.html#g68a0e6728e47cf2f9d543a0002ff3f49">file_set_status()</a> to change its status.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$source</em>&nbsp;</td><td>A string specifying the name of the upload field to save. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$validators</em>&nbsp;</td><td>An optional, associative array of callback functions used to validate the file. The keys are function names and the values arrays of callback parameters which will be passed in after the user and file objects. The functions should return an array of error messages, an empty array indicates that the file passed validation. The functions will be called in the order specified. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$dest</em>&nbsp;</td><td>A string containing the directory $source should be copied to. If this is not provided or is not writable, the temporary directory will be used. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An array containing the file information, or 0 in the event of an error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="1131c2060eba36813763eb04dd6d4843"></a><!-- doxytag: member="field_file.inc::field_file_strip_path" ref="1131c2060eba36813763eb04dd6d4843" args="($path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_strip_path           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>path</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove a possible leading file directory path from the given path. 
</div>
</div><p>
<a class="anchor" name="f4979515f095d3531c51f752100da7b1"></a><!-- doxytag: member="field_file.inc::field_file_urlencode_path" ref="f4979515f095d3531c51f752100da7b1" args="($path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">field_file_urlencode_path           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>path</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Encode a file path in a way that is compatible with <a class="el" href="group__file.html#g1a305a4da1e6e5c6b1783ceffb66c340">file_create_url()</a>.<p>
This function should be used on the $file-&gt;filepath property before any call to <a class="el" href="group__file.html#g1a305a4da1e6e5c6b1783ceffb66c340">file_create_url()</a>. This ensures that the file directory path prefix is unmodified, but the actual path to the file will be properly URL encoded. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Feb 12 18:59:45 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
