<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>update.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>update.php File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#5bf6dfe9ba7ee16c648e3932aa76535d">MAINTENANCE_MODE</a> </td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#68749bcc3e7949ede51c5dd2db91f39e">db_add_column</a> (&amp;$ret, $table, $column, $type, $attributes=array())</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#f6bd7fe55aa398bb18266c56be8bf97b">db_change_column</a> (&amp;$ret, $table, $column, $column_new, $type, $attributes=array())</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#2ee6f43ad07357556589cfcee024e203">update_do_one</a> ($module, $number, &amp;$context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="48489df1aa5e2189ef6e7fae71de8203"></a><!-- doxytag: member="update.php::update_selection_page" ref="48489df1aa5e2189ef6e7fae71de8203" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_selection_page</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6190d3cb165751d2620de354a95bccda"></a><!-- doxytag: member="update.php::update_script_selection_form" ref="6190d3cb165751d2620de354a95bccda" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_script_selection_form</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0609048e545eeffbc24aafae61dbbe40"></a><!-- doxytag: member="update.php::update_batch" ref="0609048e545eeffbc24aafae61dbbe40" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_batch</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="80f7fdd8ca66ebda4959b9429fc343f3"></a><!-- doxytag: member="update.php::update_finished" ref="80f7fdd8ca66ebda4959b9429fc343f3" args="($success, $results, $operations)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_finished</b> ($success, $results, $operations)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b8c386cf40f35717b820735b5a8f7745"></a><!-- doxytag: member="update.php::update_results_page" ref="b8c386cf40f35717b820735b5a8f7745" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_results_page</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1c9b293ee11117ef8911b52809e75bde"></a><!-- doxytag: member="update.php::update_info_page" ref="1c9b293ee11117ef8911b52809e75bde" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_info_page</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a43f1c9a3442570821ad190a3dd429db"></a><!-- doxytag: member="update.php::update_access_denied_page" ref="a43f1c9a3442570821ad190a3dd429db" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>update_access_denied_page</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#123fb38f4b7623d8ee5948c0d2e748eb">update_create_batch_table</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#b86cb0f00b89fc52f7f6294be9a1e33c">update_fix_compatibility</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#39592132a77fd791c44a8d6faf362cb0">update_check_incompatibility</a> ($name, $type= 'module')</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#f9abb57ca11fefe877843be4211307c4">update_fix_d6_requirements</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#3563d865f4b5eb7e86e9254410438679">update_task_list</a> ($active=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8php.html#d0b8cf7510033800502402c275add53b">update_check_requirements</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7c93a81c9b28ec2f78f33cdabda28c76"></a><!-- doxytag: member="update.php::$op" ref="7c93a81c9b28ec2f78f33cdabda28c76" args="" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>$op</b> = isset($_REQUEST['op']) ? $_REQUEST['op'] : ''</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Administrative page for handling updates from one Drupal version to another.<p>
Point your browser to "http://www.example.com/update.php" and follow the instructions.<p>
If you are not logged in as administrator, you will need to modify the access check statement inside your settings.php file. After finishing the upgrade, be sure to open settings.php again, and change it back to its original state! <hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="5bf6dfe9ba7ee16c648e3932aa76535d"></a><!-- doxytag: member="update.php::MAINTENANCE_MODE" ref="5bf6dfe9ba7ee16c648e3932aa76535d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="update_8php.html#5bf6dfe9ba7ee16c648e3932aa76535d">MAINTENANCE_MODE</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Global flag to identify <a class="el" href="update_8php.html">update.php</a> run, and so avoid various unwanted operations, such as hook_init() and hook_exit() invokes, css/js preprocessing and translation, and solve some theming issues. This flag is checked on several places in Drupal code (not just <a class="el" href="update_8php.html">update.php</a>). 
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="68749bcc3e7949ede51c5dd2db91f39e"></a><!-- doxytag: member="update.php::db_add_column" ref="68749bcc3e7949ede51c5dd2db91f39e" args="(&amp;$ret, $table, $column, $type, $attributes=array())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">db_add_column           </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>column</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>attributes</em> = <code>array()</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a column to a database using syntax appropriate for PostgreSQL. Save result of SQL commands in $ret array.<p>
Note: when you add a column with NOT NULL and you are not sure if there are already rows in the table, you MUST also add DEFAULT. Otherwise PostgreSQL won't work when the table is not empty, and <a class="el" href="update_8php.html#68749bcc3e7949ede51c5dd2db91f39e">db_add_column()</a> will fail. To have an empty string as the default, you must use: 'default' =&gt; "''" in the $attributes array. If NOT NULL and DEFAULT are set the PostgreSQL version will set values of the added column in old rows to the DEFAULT value.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$ret</em>&nbsp;</td><td>Array to which results will be added. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$table</em>&nbsp;</td><td>Name of the table, without {} </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$column</em>&nbsp;</td><td>Name of the column </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$type</em>&nbsp;</td><td>Type of column </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$attributes</em>&nbsp;</td><td>Additional optional attributes. Recognized attributes: not null =&gt; TRUE|FALSE default =&gt; NULL|FALSE|value (the value must be enclosed in '' marks) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing, but modifies $ret parameter. </dd></dl>

</div>
</div><p>
<a class="anchor" name="f6bd7fe55aa398bb18266c56be8bf97b"></a><!-- doxytag: member="update.php::db_change_column" ref="f6bd7fe55aa398bb18266c56be8bf97b" args="(&amp;$ret, $table, $column, $column_new, $type, $attributes=array())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">db_change_column           </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>column</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>column_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>attributes</em> = <code>array()</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change a column definition using syntax appropriate for PostgreSQL. Save result of SQL commands in $ret array.<p>
Remember that changing a column definition involves adding a new column and dropping an old one. This means that any indices, primary keys and sequences from serial-type columns are dropped and might need to be recreated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$ret</em>&nbsp;</td><td>Array to which results will be added. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$table</em>&nbsp;</td><td>Name of the table, without {} </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$column</em>&nbsp;</td><td>Name of the column to change </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$column_new</em>&nbsp;</td><td>New name for the column (set to the same as $column if you don't want to change the name) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$type</em>&nbsp;</td><td>Type of column </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$attributes</em>&nbsp;</td><td>Additional optional attributes. Recognized attributes: not null =&gt; TRUE|FALSE default =&gt; NULL|FALSE|value (with or without '', it won't be added) </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>nothing, but modifies $ret parameter. </dd></dl>

</div>
</div><p>
<a class="anchor" name="39592132a77fd791c44a8d6faf362cb0"></a><!-- doxytag: member="update.php::update_check_incompatibility" ref="39592132a77fd791c44a8d6faf362cb0" args="($name, $type= 'module')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_check_incompatibility           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>type</em> = <code>'module'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper function to test compatibility of a module or theme. 
</div>
</div><p>
<a class="anchor" name="d0b8cf7510033800502402c275add53b"></a><!-- doxytag: member="update.php::update_check_requirements" ref="d0b8cf7510033800502402c275add53b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_check_requirements           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check update requirements and report any errors. 
</div>
</div><p>
<a class="anchor" name="123fb38f4b7623d8ee5948c0d2e748eb"></a><!-- doxytag: member="update.php::update_create_batch_table" ref="123fb38f4b7623d8ee5948c0d2e748eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_create_batch_table           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create the batch table.<p>
This is part of the Drupal 5.x to 6.x migration. 
</div>
</div><p>
<a class="anchor" name="2ee6f43ad07357556589cfcee024e203"></a><!-- doxytag: member="update.php::update_do_one" ref="2ee6f43ad07357556589cfcee024e203" args="($module, $number, &amp;$context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_do_one           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>context</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform one update and store the results which will later be displayed on the finished page.<p>
An update function can force the current and all later updates for this module to abort by returning a $ret array with an element like: $ret['abort'] = array('success' =&gt; FALSE, 'query' =&gt; 'What went wrong'); The schema version will not be updated in this case, and all the aborted updates will continue to appear on <a class="el" href="update_8php.html">update.php</a> as updates that have not yet been run.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$module</em>&nbsp;</td><td>The module whose update will be run. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$number</em>&nbsp;</td><td>The update number to run. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$context</em>&nbsp;</td><td>The batch context array </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="b86cb0f00b89fc52f7f6294be9a1e33c"></a><!-- doxytag: member="update.php::update_fix_compatibility" ref="b86cb0f00b89fc52f7f6294be9a1e33c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_fix_compatibility           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Disable anything in the {system} table that is not compatible with the current version of Drupal core. 
</div>
</div><p>
<a class="anchor" name="f9abb57ca11fefe877843be4211307c4"></a><!-- doxytag: member="update.php::update_fix_d6_requirements" ref="f9abb57ca11fefe877843be4211307c4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_fix_d6_requirements           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform Drupal 5.x to 6.x updates that are required for <a class="el" href="update_8php.html">update.php</a> to function properly.<p>
This function runs when <a class="el" href="update_8php.html">update.php</a> is run the first time for 6.x, even before updates are selected or performed. It is important that if updates are not ultimately performed that no changes are made which make it impossible to continue using the prior version. Just adding columns is safe. However, renaming the system.description column to owner is not. Therefore, we add the system.owner column and leave it to system_update_6008() to copy the data from description and remove description. The same for renaming locales_target.locale to locales_target.language, which will be finished by locale_update_6002(). 
</div>
</div><p>
<a class="anchor" name="3563d865f4b5eb7e86e9254410438679"></a><!-- doxytag: member="update.php::update_task_list" ref="3563d865f4b5eb7e86e9254410438679" args="($active=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_task_list           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>active</em> = <code>NULL</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add the update task list to the current page. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Feb 12 18:59:45 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
